<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Juego de Fútbol con Porterías</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      text-align: center;
      margin: 0;
      padding: 0;
      background-color: #4CAF50;
      color: #fff;
    }
    #scoreboard {
      margin: 20px;
      font-size: 24px;
    }
    #game-area {
      position: relative;
      width: 800px;
      height: 500px;
      margin: 0 auto;
      background-color: #006400;
      border: 5px solid #fff;
      overflow: hidden;
    }
    .player {
      position: absolute;
      width: 40px;
      height: 40px;
      background-color: blue;
      border-radius: 50%;
      transition: background-color 0.3s;
    }
    .team-red {
      background-color: red;
    }
    #ball {
      position: absolute;
      width: 30px;
      height: 30px;
      background-color: white;
      border-radius: 50%;
    }
    .goal {
      position: absolute;
      width: 20px;
      height: 120px;
      background-color: yellow;
      top: 190px;
    }
    .goal.left {
      left: -20px;
    }
    .goal.right {
      right: -20px;
    }
  </style>
</head>
<body>
  <h1>Fútbol 2 vs 2</h1>
  <div id="scoreboard">Equipo Azul: 0 | Equipo Rojo: 0</div>
  <div id="game-area">
    <div id="ball" style="left: 385px; top: 235px;"></div>
    <!-- Equipo Azul -->
    <div class="player" id="blue1" style="left: 100px; top: 200px;"></div>
    <div class="player" id="blue2" style="left: 100px; top: 300px;"></div>
    <!-- Equipo Rojo -->
    <div class="player team-red" id="red1" style="left: 660px; top: 200px;"></div>
    <div class="player team-red" id="red2" style="left: 660px; top: 300px;"></div>
    <!-- Porterías -->
    <div class="goal left"></div>
    <div class="goal right"></div>
  </div>

  <script>
    const gameArea = document.getElementById("game-area");
    const ball = document.getElementById("ball");
    const scoreboard = document.getElementById("scoreboard");
    const players = {
      blue1: document.getElementById("blue1"),
      blue2: document.getElementById("blue2"),
      red1: document.getElementById("red1"),
      red2: document.getElementById("red2"),
    };
    let blueScore = 0;
    let redScore = 0;

    const keys = {};
    const playerSpeed = 7;
    const friction = 0.95;
    let ballSpeed = { x: 0, y: 0 };

    document.addEventListener("keydown", (e) => {
      keys[e.key.toLowerCase()] = true;
    });
    document.addEventListener("keyup", (e) => {
      keys[e.key.toLowerCase()] = false;
    });

    function movePlayer(player, dx, dy) {
      let currentX = parseInt(player.style.left);
      let currentY = parseInt(player.style.top);
      let newX = currentX + dx;
      let newY = currentY + dy;

      if (newX < 0) newX = 0;
      if (newY < 0) newY = 0;
      if (newX > gameArea.clientWidth - player.clientWidth) newX = gameArea.clientWidth - player.clientWidth;
      if (newY > gameArea.clientHeight - player.clientHeight) newY = gameArea.clientHeight - player.clientHeight;

      player.style.left = newX + "px";
      player.style.top = newY + "px";
    }

    function moveBall() {
      let currentX = parseInt(ball.style.left);
      let currentY = parseInt(ball.style.top);
      let newX = currentX + ballSpeed.x;
      let newY = currentY + ballSpeed.y;

      if (newX < 0 || newX > gameArea.clientWidth - ball.clientWidth) ballSpeed.x *= -1;
      if (newY < 0 || newY > gameArea.clientHeight - ball.clientHeight) ballSpeed.y *= -1;

      ballSpeed.x *= friction;
      ballSpeed.y *= friction;

      ball.style.left = Math.max(0, Math.min(gameArea.clientWidth - ball.clientWidth, newX)) + "px";
      ball.style.top = Math.max(0, Math.min(gameArea.clientHeight - ball.clientHeight, newY)) + "px";
    }

    function detectCollisions() {
      for (let key in players) {
        const player = players[key];
        const playerRect = player.getBoundingClientRect();
        const ballRect = ball.getBoundingClientRect();
        const gameAreaRect = gameArea.getBoundingClientRect();

        const playerX = playerRect.left - gameAreaRect.left;
        const playerY = playerRect.top - gameAreaRect.top;

        if (
          playerX < parseInt(ball.style.left) + ball.clientWidth &&
          playerX + player.clientWidth > parseInt(ball.style.left) &&
          playerY < parseInt(ball.style.top) + ball.clientHeight &&
          playerY + player.clientHeight > parseInt(ball.style.top)
        ) {
          const centerPlayerX = playerX + player.clientWidth / 2;
          const centerPlayerY = playerY + player.clientHeight / 2;
          const centerBallX = parseInt(ball.style.left) + ball.clientWidth / 2;
          const centerBallY = parseInt(ball.style.top) + ball.clientHeight / 2;

          const angle = Math.atan2(centerBallY - centerPlayerY, centerBallX - centerPlayerX);
          const force = 5;

          ballSpeed.x += Math.cos(angle) * force;
          ballSpeed.y += Math.sin(angle) * force;
        }
      }
    }

    function detectGoals() {
      const ballLeft = parseInt(ball.style.left);
      const ballRight = ballLeft + ball.clientWidth;
      const ballTop = parseInt(ball.style.top);
      const ballBottom = ballTop + ball.clientHeight;

      if (ballLeft <= 0 && ballTop >= 190 && ballBottom <= 310) {
        redScore++;
        updateScoreboard();
        resetBall();
      }

      if (ballRight >= gameArea.clientWidth && ballTop >= 190 && ballBottom <= 310) {
        blueScore++;
        updateScoreboard();
        resetBall();
      }
    }

    function updateScoreboard() {
      scoreboard.textContent = `Equipo Azul: ${blueScore} | Equipo Rojo: ${redScore}`;
    }

    function resetBall() {
      ball.style.left = "385px";
      ball.style.top = "235px";
      ballSpeed = { x: 0, y: 0 };
    }

    function gameLoop() {
      if (keys["w"]) movePlayer(players.blue1, 0, -playerSpeed);
      if (keys["s"]) movePlayer(players.blue1, 0, playerSpeed);
      if (keys["a"]) movePlayer(players.blue1, -playerSpeed, 0);
      if (keys["d"]) movePlayer(players.blue1, playerSpeed, 0);

      if (keys["i"]) movePlayer(players.blue2, 0, -playerSpeed);
      if (keys["k"]) movePlayer(players.blue2, 0, playerSpeed);
      if (keys["j"]) movePlayer(players.blue2, -playerSpeed, 0);
      if (keys["l"]) movePlayer(players.blue2, playerSpeed, 0);

      if (keys["arrowup"]) movePlayer(players.red1, 0, -playerSpeed);
      if (keys["arrowdown"]) movePlayer(players.red1, 0, playerSpeed);
      if (keys["arrowleft"]) movePlayer(players.red1, -playerSpeed, 0);
      if (keys["arrowright"]) movePlayer(players.red1, playerSpeed, 0);

      moveBall();
      detectCollisions();
      detectGoals();

      requestAnimationFrame(gameLoop);
    }

    gameLoop();
  </script>
</body>
</html>
