<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Juego de Fútbol Mejorado</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      text-align: center;
      margin: 0;
      padding: 0;
      background-color: #4CAF50;
    }
    #game-area {
      position: relative;
      width: 800px;
      height: 500px;
      margin: 20px auto;
      background-color: #fff;
      border: 5px solid #000;
    }
    .player {
      position: absolute;
      width: 40px;
      height: 40px;
      background-color: blue;
      border-radius: 50%;
    }
    .player.team-red {
      background-color: red;
    }
    #ball {
      position: absolute;
      width: 30px;
      height: 30px;
      background-color: black;
      border-radius: 50%;
    }
    #scoreboard {
      margin-top: 20px;
      font-size: 24px;
      color: #fff;
    }
    .goal {
      position: absolute;
      width: 20px;
      height: 100px;
      background-color: yellow;
    }
    .goal.left {
      top: 200px;
      left: 0;
    }
    .goal.right {
      top: 200px;
      right: 0;
    }
  </style>
</head>
<body>
  <h1>Fútbol Mejorado</h1>
  <div id="scoreboard">Equipo Azul: 0 | Equipo Rojo: 0</div>
  <div id="game-area">
    <div id="ball"></div>
    <div class="player team-blue" id="blue1" style="top: 200px; left: 100px;"></div>
    <div class="player team-blue" id="blue2" style="top: 300px; left: 100px;"></div>
    <div class="player team-red" id="red1" style="top: 200px; left: 600px;"></div>
    <div class="player team-red" id="red2" style="top: 300px; left: 600px;"></div>
    <div class="goal left"></div>
    <div class="goal right"></div>
  </div>
  <script>
    const gameArea = document.getElementById("game-area");
    const ball = document.getElementById("ball");
    const players = {
      blue1: document.getElementById("blue1"),
      blue2: document.getElementById("blue2"),
      red1: document.getElementById("red1"),
      red2: document.getElementById("red2"),
    };
    const scoreboard = document.getElementById("scoreboard");
    let blueScore = 0;
    let redScore = 0;

    const ballSpeed = { x: 0, y: 0 }; // Velocidad de la pelota.
    const playerSpeed = 7; // Velocidad de los jugadores.
    const friction = 0.98; // Fricción para la pelota.
    const keys = {};

    document.addEventListener("keydown", (e) => (keys[e.key] = true));
    document.addEventListener("keyup", (e) => (keys[e.key] = false));

    function movePlayer(player, dx, dy) {
      const rect = player.getBoundingClientRect();
      const areaRect = gameArea.getBoundingClientRect();
      let newX = rect.left + dx - areaRect.left;
      let newY = rect.top + dy - areaRect.top;

      if (newX < 0) newX = 0;
      if (newY < 0) newY = 0;
      if (newX + rect.width > areaRect.width) newX = areaRect.width - rect.width;
      if (newY + rect.height > areaRect.height) newY = areaRect.height - rect.height;

      player.style.left = newX + "px";
      player.style.top = newY + "px";
    }

    function moveBall() {
      const rect = ball.getBoundingClientRect();
      const areaRect = gameArea.getBoundingClientRect();
      let newX = rect.left + ballSpeed.x;
      let newY = rect.top + ballSpeed.y;

      if (newX < 0 || newX + rect.width > areaRect.width) ballSpeed.x *= -1;
      if (newY < 0 || newY + rect.height > areaRect.height) ballSpeed.y *= -1;

      ball.style.left = Math.max(0, Math.min(areaRect.width - rect.width, newX)) + "px";
      ball.style.top = Math.max(0, Math.min(areaRect.height - rect.height, newY)) + "px";

      ballSpeed.x *= friction;
      ballSpeed.y *= friction;
    }

    function detectCollision(player) {
      const playerRect = player.getBoundingClientRect();
      const ballRect = ball.getBoundingClientRect();

      const overlapX = Math.abs(playerRect.left - ballRect.left) < playerRect.width;
      const overlapY = Math.abs(playerRect.top - ballRect.top) < playerRect.height;

      if (overlapX && overlapY) {
        const angle = Math.atan2(
          ballRect.top - playerRect.top,
          ballRect.left - playerRect.left
        );
        ballSpeed.x += Math.cos(angle) * 5;
        ballSpeed.y += Math.sin(angle) * 5;
      }
    }

    function detectGoal() {
      const ballRect = ball.getBoundingClientRect();
      const areaRect = gameArea.getBoundingClientRect();

      if (ballRect.left <= 0) {
        redScore++;
        resetBall();
      } else if (ballRect.right >= areaRect.width) {
        blueScore++;
        resetBall();
      }

      scoreboard.textContent = `Equipo Azul: ${blueScore} | Equipo Rojo: ${redScore}`;
    }

    function resetBall() {
      ball.style.left = "385px";
      ball.style.top = "235px";
      ballSpeed.x = 0;
      ballSpeed.y = 0;
    }

    function gameLoop() {
      if (keys["w"]) movePlayer(players.blue1, 0, -playerSpeed);
      if (keys["s"]) movePlayer(players.blue1, 0, playerSpeed);
      if (keys["a"]) movePlayer(players.blue1, -playerSpeed, 0);
      if (keys["d"]) movePlayer(players.blue1, playerSpeed, 0);

      if (keys["i"]) movePlayer(players.blue2, 0, -playerSpeed);
      if (keys["k"]) movePlayer(players.blue2, 0, playerSpeed);
      if (keys["j"]) movePlayer(players.blue2, -playerSpeed, 0);
      if (keys["l"]) movePlayer(players.blue2, playerSpeed, 0);

      if (keys["ArrowUp"]) movePlayer(players.red1, 0, -playerSpeed);
      if (keys["ArrowDown"]) movePlayer(players.red1, 0, playerSpeed);
      if (keys["ArrowLeft"]) movePlayer(players.red1, -playerSpeed, 0);
      if (keys["ArrowRight"]) movePlayer(players.red1, playerSpeed, 0);

      for (let player in players) {
        detectCollision(players[player]);
      }

      moveBall();
      detectGoal();
      requestAnimationFrame(gameLoop);
    }

    resetBall();
    gameLoop();
  </script>
</body>
</html>
